\chapter{Практика}\label{ch:ch3}

\section{Мобильный автономный робот}
Для решения задачи данной работы необходимо было проводить <<живые>> тестирования работы алгоритмов. Такая необходимость обусловлена прежде всего тем, что помимо существующей задачи данной ВКР стояла задача в создании робота для распознавания объектов. По этой причине было принято решение делать алгоритмы на реальном роботе\footnote{Задание данной ВКР можно было бы сделать и в любом симуляторе или игровом движке. Однако решение делать всё в реальной жизни сильно усложнило данную задачу.} с пребыванием данного робота во вполне реальных условиях.

\subsection{Подбор шасси}
Как было сказано в \fixme{первой} главе данной работы, существует большое количество различных шасси, на которых можно располагать различное оборудование. Наш выбор остановился на гусеничном шасси, которое \fixme{изображено на Рисунке }.

Данное шасси за счёт своих размеров является очень мобильным средством передвижения робота и может проникнуть в относительно узкие для роботов пространства и без проблем оттуда выбраться, не повредившись. Для оборудования на данном шасси место тоже нашлось: для этого было принято решение заказать металлическую пластину, которая играла роль второго этажа. \fixme{поставить рисунок?}

\subsection{Движение шасси}

К сожалению, по неизвестной причине к данному шасси не пришёл комплектный контроллер движения, который бы принимал команды от компьютера и заставлял двигаться установленные гусеницы. По этой причине пришлось немного изучить ещё одну предметную область, которая не изучалась в течении университетского курса - электротехнику. 

\subsubsection{Требования к контроллеру движений}

Компьютер, который будет в последствии установлен на робота будет управлять роботом посредством бинарных сигналов с напряжением 3.3В через порт GPIO, где 0 (или по-другому нет напряжения) - это движение не требуется и 1 (когда есть напряжение +3.3В), когда движение требуется.

Контроллер должен, также, уметь по отдельности управлять двумя гусеницами, заставлять их ездить вперёд и назад. Это основные требования. Из дополнительных требований можно выделить умение каким-то образом регулировать скорость движения. Общая структура желаемой модели контроллера \fixme{изображена на Рисунке }. 

\subsubsection{Схема будущего контроллера}

	\fixme{Здесь теоретическое объяснение как работает контроллер}

\subsubsection{Производство контроллера}

В качестве основы для контроллера было принято решение взять текстолитовую пластину c медным покрытием, \fixme{изображённую на рисунке }.
	
Далее на нём при помощи перманентного маркера были нанесены дорожки, а места вставки деталей были просверлены советской стоматологической бур-машинкой. Далее всё это прошло ванну хлорида железа. Процесс и результаты работы \fixme{изображены на Рисунке }.
	
\subsubsection{Результаты работы}

Таким образом был получен полноценный контроллер, который умеет управлять роботом медленной и быстрой скоростями. Однако, не обошлось без недостатков и трудностей. Главной трудностью стал неудачный способ стравливания дорожек на плате, поэтому пришлось дополнительно при помощи олова проводить дорожки и искать потенциально уязвивмые места.

После большой ручной работы плату удалось запустить, но появилась другая проблема. И эта проблема заключалась в том, что сопротивление двигателей робота немного отличалось друг от друга, также как и сопротивление резисторов, установленных на плату. Данное отличие было ничтожным, но этого вполне хватало, чтобы робот начинал ездить не очень ровно и его всё время приходилось дополнительно корректировать.

\subsubsection{Вторая версия контроллера}

Необходимость во второй версии контроллера возникла в первую очередь из-за того, что медленная скорость на роботе работала слишком медленно, а быстрая слишком быстро. Ездить в магазин и вручную подбирать резисторы, каждый раз перепаивая плату совсем не хотелось, а каждый резистор в местных магазинах обходится в неприятную для таких расходных деталей сумму. 

Переделка первой версии платы обошлась бы слишком дорого в плане времени, да и к тому же не хотелось портить, то, что и так уже работает. Поэтому вторая версия платы была собрана по той же схеме, что и первая, но с несколькими важными отличиями. Из стабилизаторов остался только стабилизатор на 9В, а обычные резисторы были заменены на соответствующие подстроечные резисторы. Таким образом должна была появилась возможность регулировать движение в зависимости от того, в каком положении будет установлен сам резистор. Получившаяся плата \fixme{изображена на Рисунке }.

Однако, что-то пошло не так и настройка резисторов превратилась в процесс настройки <<лишь бы работало>>. Всё дело в том, что на плате образовался какая-то токоутечка (к сожалению, я в плане электротехники и радиофизики являюсь дилетантом, поэтому не могу подобрать настоящего термина к данному процессу) и существовало много вариантов настроить подстроечные резисторы так, что, например, при команде ехать быстро вперёд одна гусеница ехала нормально, а вторая начинала резко дёргаться или вести себя каким-либо случайным и неестественным образом (бывало даже так, что одна гусеница вдруг начинала ехать назад, хотя этому ничего не предвещало).

И всё же существовала такая настройка резисторов, при которой робот начинал нормально слушаться команд, но затем научный консультант предоставил нам ещё одно шасси, на котором затем и продолжилась разработка окончательной версии робота.

\section{Визуальный анализ пространства}
Для анализа окружающего пространства существует довольно большое количество различных датчиков и прочего оборудования. Но закупать сразу всё не выгодно экономически, затратно в плане места размещения на роботе и расточительно в плане потребления электроэнергии этими самыми датчиками. Также для обработки всех этих сигналов нужны соответствующие вычислительные мощности. 

Таким образом робот должен иметь совсем небольшое количество сенсоров и при этом не быть <<слепым>>. Исходя из этих соображений, было решено установить на робота два основных сенсора. Лазерный сканер YDLIDAR X4 и CSI камера Sony IMX217. Первый поможет видеть препятствия вокруг робота, второй поможет видеть объекты, размещённые перед роботом. 

Схему размещения сенсоров \fixme{размещена на Рисунке }.

\section{Формирование поведенческой стратегии робота}

Основная задача робота - ездить и искать целевые объекты делится на две подзадачи.

\subsection{Езда}

Этот режим поездки можно также назвать режимом исследователя. В идеальном случае, робот в начале работы алгоритма движения должен объездить всё доступное ему пространство, составить карту окружающей местности, параллельно при этом запоминая увиденные им объекты и их примерное местоположение\footnote{его нужно вычислять из расчётов того, куда смотрит в данный момент робот, угла прямоугольника на изображении, на котором объект был обнаружен}, а затем после полного сканирования объехать всю территорию и убедиться в том, что целевые объекты действительно были найдены на этих местах. И это должно стать конечной целью робота. Однако, для упрощения данной задачи будет использоваться другой куда более простой алгоритм. 

Режим исследователя будет подразумевать под собой то, что робот будет просто ехать вперёд, параллельно разыскивая целевые объекты и объезжая препятствия. 

\subsubsection{Объезд препятствий}

Робот должен уметь объезжать хотя-бы самые простейшие препятствия, по типу стен, диванов или прочих перегородок. В идеале, он должен уметь справляться и с тонкими препятствиями по типу ножек стула и мягкие поверхности.

Алгоритм объезда препятствий, представленный на данном роботе сводится к схеме, \fixme{изображённой на Рисунке }.

Подсчёт того, где свободнее: слева или справа идёт из соображений того, где находится больше препятствий. Как это считается? Условно робот поделён на несколько направлений. В данном случае он подразделён на <<перед>>, <<лево>>, <<право>> и <<зад>>. Лидар выдаёт данные в формате обычных чисел в формате float. Всего этих чисел 720, из чего можно сделать вывод, что цена деления лидара это полградуса. По каждой из сторон считается обычное среднее арифметическое число. Как только это число достигает некоторого предела, заданного константой, робот начинает искать путь обхода. Вариантов обойти препятствия всего два: поехать налево или направо. Считается среднее арифметическое число с левой стороны и с правой. Затем выбирается та сторона, у которой это число оказалось меньше. Однако, этого всё ещё недостаточно чтобы объезжать часто встречаемые препятствия. 

\subsubsection{Обнаружение застревания}

Робот может попасть в ситуацию, когда впереди внезапно образовалась преграда, невидимая для лазерного сканера (например, очень низкая преграда). Для обнаружения застревания при столкновении с такими преградами необходимо как-то понять, что робот перестал двигаться. 

Одним из способов понять и распознать застревание может стать анализ облака точек, которые выдаёт LIDAR. Если вектор движения большинства точек на плоскости облака стал достаточно мал, то можно сделать вывод о том, что робот либо плохо двигается, либо вообще застрял. 

В данный проект была встроена система Google Cartographer, которая по облаку точек может строить окружающую карту местности, а также определять местоположение робота на ней. Информацию о местоположении можно использовать как раз в целях определения застревания. Если в течении секунды координаты робота менялись недостаточно сильно, то значит робот застрял.

Для выезда из застревания используется простой алгоритм, который состоит из 3 шагов:

\begin{enumerate}
\item Ехать назад 2 секунды;
\item Выбрать сторону, в которую будет совершён поворот;
\item Ехать дальше.
\end{enumerate}

Как показала практика, этот алгоритм работает достаточно эффективно для того чтобы не застревать в большинстве ситуаций.

\subsection{Поиск целевого объекта}

Данный режим предполагается включать только в случае, если на видеосигнале, получаемом от CSI камеры был распознан целевой объект. В этом случае робот останавливается и поворачивается в ту сторону, где расположен центр предполагаемого целевого объекта. Далее робот начинает ехать вперёд и по мере необходимости продолжает центрировать шасси до тех пор пока не подъедет к объекту. Далее робот останавливается, конечная цель робота выполнена: целевой объект найден.

Определение того, что робот подъехал к объекту происходит по размеру прямоугольника, на котором обозначен целевой объект. Если прямоугольник уже достиг краёв кадра видеосигнала, значит робот приблизился к объекту максимально близко. Подъезд вплотную к объекту является не самой лучшей идеей, так как целевым объектом может быть стеклянная бутылка, которую можно просто сбить и разбить. 

\section{Программная часть}
\fixme{Здесь пишем об ОС, установленном на робота. О ROS и о собственных программных реализациях.}

\section{Ещё одно шасси}
Как и было сказано ранее, от научного консультанта по ВКР было получено шасси другого образца, \fixme{изображённое на рисунке }.

Данное шасси по своей длине гораздо больше, менее мобильно. Это пришлось учитывать при переделке алгоритма движения робота. Однако, пришлось переделать и ещё кое-что.

\subsection{Делегирование задач}

Так как на выданном роботе уже установлен и подключен одноплатный компьютер OrangePI PC было принято решение делегировать на него задачу передвижения робота, а конкретно в обязанности этого компьютера будут входить:

\begin{enumerate}
	\item Управление лидаром и обработка сигналов от него;
	\item Постройка карты окружающей местности и определение внутренних координат на ней;
	\item Непосредственное управление электродвигателями робота через разъём GPIO;
	\item Управление роботом в режиме исследователя и при нахождении целевого объекта.
\end{enumerate}

\subsection{Объединение 2 компьютеров}

Для выполнения выше поставленных задач компьютер Orange PI PC должен быть напрямую связан со вторым компьютером NVIDIA Jetson NANO.

\subsubsection{Локальная сеть}

Было принято решение физически связать эти два компьютера при помощи имеющихся на них разъёмах для Ethernet. Программно два компьютера были связаны при помощи встроенной в ОС Ubuntu (установленной на Jetson) функции предоставления сети. Таким образом, подключенный к беспроводной сети Wi-Fi и к проводу Jetson NANO, может не только выходить в интернет, а ещё и предоставлять этот интернет компьютеру Orange PI PC, у которого встроенного Wi-Fi модуля нет. 

В полевых условиях (в которых в последствии робот должен будет оказаться), естественно никакой беспроводной сети с интернетом не будет. Однако, это удобно для разработки и отладки. А в случае, если понадобится подключить мобильный интернет, это можно будет также сделать через Jetson NANO.

\subsubsection{Объединение ROS}
После того, как два компьютера соединились друг с другом, можно начать пересылку информации. Для этих целей можно написать ряд отдельных клиент-серверных приложений, которые при помощи сокетов будут передавать различные данные. Например, Jetson NANO будет передавать на Orange PI PC координаты объекта, которые он видит в кадре.

Оказалось, что писать для этого отдельные приложения не требуется. Объединение нескольких компьютеров возможно и при помощи встроенных в Robot Operating System штатных средств.

При объединении компьютеров в начале нужно выяснить кто из компьютеров будет главным ядром системы (в последствии на этом компьютере будет запущен мастер-узел roscore). Было решено, что ядром станет Jetson NANO, так как он имеет более высокие вычислительные мощности. 

Зависимый от главного компьютер (в нашем случае Orange PI PC) при этом должен хранить в своём рабочем окружении две ключевых переменных ROS\_MASTER\_URI и ROS\_IP. Первая задаётся в виде: http://ip-адрес-компьютера-с-roscore:11311/. Во второй переменной просто должен содержаться собственный IP адрес компьютера. На Orange PI PC эти переменные установлены в этих значениях:
ROS\_MASTER\_URI=http://10.42.0.1:11311/
ROS\_IP=10.42.0.240  

После объявления этих переменных, между компьютерами создаётся двухсторонняя связь, в которой оба компьютера видят друг у друга все публикующиеся сообщения и могут присоединяться к различным сервисам. Схема соединения компьютеров \fixme{представлена на Рисунке }.

\subsection{Лазерное сканирование}

Следующая проблема возникает в связи с конструкцией, которая установлена на робота. В середине корпуса имеется непрозрачное препятствие, которое мешает лазерному сканированию при помощи LIDAR. Поэтому было принято решение установить второй LIDAR с другой стороны, а затем в алгоритме движения робота учесть этот момент.

\fixme{Здесь расписать как решена задача объединения лидаров...}  

\section{Таблица обыкновенная}\label{sec:ch3/sect1}

Так размещается таблица:

\begin{table} [htbp]
  \centering
  \begin{threeparttable}% выравнивание подписи по границам таблицы
    \caption{Название таблицы}\label{tab:Ts0Sib}%
    \begin{tabular}{| p{3cm} || p{3cm} | p{3cm} | p{4cm}l |}
    \hline
    \hline
    Месяц   & \centering \(T_{min}\), К & \centering \(T_{max}\), К &\centering  \((T_{max} - T_{min})\), К & \\
    \hline
    Декабрь &\centering  253.575   &\centering  257.778    &\centering      4.203  &   \\
    Январь  &\centering  262.431   &\centering  263.214    &\centering      0.783  &   \\
    Февраль &\centering  261.184   &\centering  260.381    &\centering     \(-\)0.803  &   \\
    \hline
    \hline
    \end{tabular}
  \end{threeparttable}
\end{table}

\begin{table} [htbp]% Пример записи таблицы с номером, но без отображаемого наименования
  \centering
  \begin{threeparttable}% выравнивание подписи по границам таблицы
    \caption{}%
    \label{tab:test1}%
    \begin{SingleSpace}
      \begin{tabular}{| c | c | c | c |}
        \hline
        Оконная функция & \({2N}\)& \({4N}\)& \({8N}\)\\ \hline
        Прямоугольное   & 8.72  & 8.77  & 8.77  \\ \hline
        Ханна           & 7.96  & 7.93  & 7.93  \\ \hline
        Хэмминга        & 8.72  & 8.77  & 8.77  \\ \hline
        Блэкмана        & 8.72  & 8.77  & 8.77  \\ \hline
      \end{tabular}%
    \end{SingleSpace}
  \end{threeparttable}
\end{table}

Таблица~\ref{tab:test2} "--- пример таблицы, оформленной в~классическом книжном
варианте или~очень близко к~нему. \mbox{ГОСТу} по~сути не~противоречит. Можно
ещё~улучшить представление, с~помощью пакета \verb|siunitx| или~подобного.

\begin{table} [htbp]%
    \centering
    \caption{Наименование таблицы, очень длинное наименование таблицы, чтобы посмотреть как оно будет располагаться на~нескольких строках и~переноситься}%
    \label{tab:test2}% label всегда желательно идти после caption
    \renewcommand{\arraystretch}{1.5}%% Увеличение расстояния между рядами, для улучшения восприятия.
    \begin{SingleSpace}
        \begin{tabular}{@{}@{\extracolsep{20pt}}llll@{}} %Вертикальные полосы не используются принципиально, как и лишние горизонтальные (допускается по ГОСТ 2.105 пункт 4.4.5) % @{} позволяет прижиматься к краям
            \toprule     %%% верхняя линейка
            Оконная функция & \({2N}\)& \({4N}\)& \({8N}\)\\
            \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5
            Прямоугольное   & 8.72  & 8.77  & 8.77  \\
            Ханна           & 7.96  & 7.93  & 7.93  \\
            Хэмминга        & 8.72  & 8.77  & 8.77  \\
            Блэкмана        & 8.72  & 8.77  & 8.77  \\
            \bottomrule %%% нижняя линейка
        \end{tabular}%
    \end{SingleSpace}
\end{table}

\section{Таблица с многострочными ячейками и примечанием}

В таблице~\ref{tab:makecell} приведён пример использования команды
\verb+\multicolumn+ для объединения горизонтальных ячеек таблицы,
и команд пакета \textit{makecell} для добавления разрыва строки внутри ячеек.
При форматировании таблицы~\ref{tab:makecell} использован стиль подписей \verb+split+.
Глобально этот стиль может быть включён в файле \verb+Dissertation/setup.tex+ для диссертации и в
файле \verb+Synopsis/setup.tex+ для автореферата.
Однако такое оформление не соответствует ГОСТ.

\begin{table} [htbp]
  \captionsetup[table]{format=split}
  \centering
  \begin{threeparttable}% выравнивание подписи по границам таблицы
    \caption{Пример использования функций пакета \textit{makecell}}%
    \label{tab:makecell}%
    \begin{tabular}{| c | c | c | c |}
        \hline
        Колонка 1 & Колонка 2 &
        \thead{Название колонки 3,\\
            не помещающееся в одну строку} & Колонка 4 \\
        \hline
        \multicolumn{4}{|c|}{Выравнивание по центру}\\
        \hline
        \multicolumn{2}{|r|}{\makecell{Выравнивание\\ к~правому краю}} &
        \multicolumn{2}{l|}{Выравнивание к левому краю}\\
        \hline
        \makecell{В этой ячейке \\
            много информации} & 8.72 & 8.55 & 8.44\\
        \cline{3-4}
        А в этой мало         & 8.22 & \multicolumn{2}{c|}{5}\\
        \hline
    \end{tabular}%
  \end{threeparttable}
\end{table}

Таблицы~\ref{tab:test3} и~\ref{tab:test4} "--- пример реализации расположения
примечания в~соответствии с ГОСТ 2.105. Каждый вариант со своими достоинствами
и~недостатками. Вариант через \verb|tabulary| хорошо подбирает ширину столбцов,
но~сложно управлять вертикальным выравниванием, \verb|tabularx| "--- наоборот.
\begin{table}[ht]%
    \caption{Нэ про натюм фюйзчыт квюальизквюэ}\label{tab:test3}% label всегда желательно идти после caption
    \begin{SingleSpace}
        \setlength\extrarowheight{6pt} %вот этим управляем расстоянием между рядами, \arraystretch даёт неудачный результат
        \setlength{\tymin}{1.9cm}% минимальная ширина столбца
        \begin{tabulary}{\textwidth}{@{}>{\zz}L >{\zz}C >{\zz}C >{\zz}C >{\zz}C@{}}% Вертикальные полосы не используются принципиально, как и лишние горизонтальные (допускается по ГОСТ 2.105 пункт 4.4.5) % @{} позволяет прижиматься к краям
            \toprule     %%% верхняя линейка
            доминг лаборамюз эи ыам (Общий съём цен шляп (юфть)) & Шеф взъярён &
            адвыржаряюм &
            тебиквюэ элььэефэнд мэдиокретатым &
            Чэнзэрет мныжаркхюм         \\
            \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5
            Эй, жлоб! Где туз? Прячь юных съёмщиц в~шкаф Плюш изъят. Бьём чуждый цен хвощ! &
            \({\approx}\) &
            \({\approx}\) &
            \({\approx}\) &
            \( + \) \\
            Эх, чужак! Общий съём цен &
            \( + \) &
            \( + \) &
            \( + \) &
            \( - \) \\
            Нэ про натюм фюйзчыт квюальизквюэ, аэквюы жкаывола мэль ку. Ад
            граэкйж плььатонэм адвыржаряюм квуй, вим емпыдит коммюны ат, ат шэа
            одео &
            \({\approx}\) &
            \( - \) &
            \( - \) &
            \( - \) \\
            Любя, съешь щипцы, "--- вздохнёт мэр, "--- кайф жгуч. &
            \( - \) &
            \( + \) &
            \( + \) &
            \({\approx}\) \\
            Нэ про натюм фюйзчыт квюальизквюэ, аэквюы жкаывола мэль ку. Ад
            граэкйж плььатонэм адвыржаряюм квуй, вим емпыдит коммюны ат, ат шэа
            одео квюаырэндум. Вёртюты ажжынтиор эффикеэнди эож нэ. &
            \( + \) &
            \( - \) &
            \({\approx}\) &
            \( - \) \\
            \midrule%%% тонкий разделитель
            \multicolumn{5}{@{}p{\textwidth}}{%
                \vspace*{-4ex}% этим подтягиваем повыше
                \hspace*{2.5em}% абзацный отступ - требование ГОСТ 2.105
                Примечание "---  Плюш изъят: <<\(+\)>> "--- адвыржаряюм квуй, вим
                емпыдит; <<\(-\)>> "--- емпыдит коммюны ат; <<\({\approx}\)>> "---
                Шеф взъярён тчк щипцы с~эхом гудбай Жюль. Эй, жлоб! Где туз?
                Прячь юных съёмщиц в~шкаф. Экс-граф?
            }
            \\
            \bottomrule %%% нижняя линейка
        \end{tabulary}%
    \end{SingleSpace}
\end{table}

Если таблица~\ref{tab:test3} не помещается на той же странице, всё
её~содержимое переносится на~следующую, ближайшую, а~этот текст идёт перед ней.
\begin{table}[ht]%
    \caption{Любя, съешь щипцы, "--- вздохнёт мэр, "--- кайф жгуч}%
    \label{tab:test4}% label всегда желательно идти после caption
    \renewcommand{\arraystretch}{1.6}%% Увеличение расстояния между рядами, для улучшения восприятия.
    \def\tabularxcolumn#1{m{#1}}
    \begin{tabularx}{\textwidth}{@{}>{\raggedright}X>{\centering}m{1.9cm} >{\centering}m{1.9cm} >{\centering}m{1.9cm} >{\centering\arraybackslash}m{1.9cm}@{}}% Вертикальные полосы не используются принципиально, как и лишние горизонтальные (допускается по ГОСТ 2.105 пункт 4.4.5) % @{} позволяет прижиматься к краям
        \toprule     %%% верхняя линейка
        доминг лаборамюз эи ыам (Общий съём цен шляп (юфть)) & Шеф взъярён &
        адвыр\-жаряюм &
        тебиквюэ элььэефэнд мэдиокретатым &
        Чэнзэрет мныжаркхюм     \\
        \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5
        Эй, жлоб! Где туз? Прячь юных съёмщиц в~шкаф Плюш изъят.
        Бьём чуждый цен хвощ! &
        \({\approx}\) &
        \({\approx}\) &
        \({\approx}\) &
        \( + \) \\
        Эх, чужак! Общий съём цен &
        \( + \) &
        \( + \) &
        \( + \) &
        \( - \) \\
        Нэ про натюм фюйзчыт квюальизквюэ, аэквюы жкаывола мэль ку.
        Ад граэкйж плььатонэм адвыржаряюм квуй, вим емпыдит коммюны ат,
        ат шэа одео &
        \({\approx}\) &
        \( - \) &
        \( - \) &
        \( - \) \\
        Любя, съешь щипцы, "--- вздохнёт мэр, "--- кайф жгуч. &
        \( - \) &
        \( + \) &
        \( + \) &
        \({\approx}\) \\
        Нэ про натюм фюйзчыт квюальизквюэ, аэквюы жкаывола мэль ку. Ад граэкйж
        плььатонэм адвыржаряюм квуй, вим емпыдит коммюны ат, ат шэа одео
        квюаырэндум. Вёртюты ажжынтиор эффикеэнди эож нэ. &
        \( + \) &
        \( - \) &
        \({\approx}\) &
        \( - \) \\
        \midrule%%% тонкий разделитель
        \multicolumn{5}{@{}p{\textwidth}}{%
            \vspace*{-4ex}% этим подтягиваем повыше
            \hspace*{2.5em}% абзацный отступ - требование ГОСТ 2.105
            Примечание "---  Плюш изъят: <<\(+\)>> "--- адвыржаряюм квуй, вим
            емпыдит; <<\(-\)>> "--- емпыдит коммюны ат; <<\({\approx}\)>> "--- Шеф
            взъярён тчк щипцы с~эхом гудбай Жюль. Эй, жлоб! Где туз? Прячь юных
            съёмщиц в~шкаф. Экс-граф?
        }
        \\
        \bottomrule %%% нижняя линейка
    \end{tabularx}%
\end{table}

\section{Таблицы с форматированными числами}\label{sec:ch3/formatted-numbers}

В таблицах~\refs{tab:S:parse,tab:S:align} представлены примеры использования опции
форматирования чисел \texttt{S}, предоставляемой пакетом \texttt{siunitx}.

\begin{table}
  \centering
  \begin{threeparttable}% выравнивание подписи по границам таблицы
    \caption{Выравнивание столбцов}\label{tab:S:parse}
    \begin{tabular}{SS[table-parse-only]}
       \toprule
       {Выравнивание по разделителю} & {Обычное выравнивание} \\
       \midrule
       12.345                        & 12.345                 \\
       6,78                          & 6,78                   \\
       -88.8(9)                      & -88.8(9)               \\
       4.5e3                         & 4.5e3                  \\
       \bottomrule
    \end{tabular}
  \end{threeparttable}
\end{table}

\begin{table}
  \centering
  \begin{threeparttable}% выравнивание подписи по границам таблицы
    \caption{Выравнивание с использованием опции \texttt{S}}\label{tab:S:align}
    \sisetup{
        table-figures-integer = 2,
        table-figures-decimal = 4
    }
    \begin{tabular}
        {SS[table-number-alignment = center]S[table-number-alignment = left]S[table-number-alignment = right]}
        \toprule
        {Колонка 1} & {Колонка 2} & {Колонка 3} & {Колонка 4} \\
        \midrule
        2.3456      & 2.3456      & 2.3456      & 2.3456      \\
        34.2345     & 34.2345     & 34.2345     & 34.2345     \\
        56.7835     & 56.7835     & 56.7835     & 56.7835     \\
        90.473      & 90.473      & 90.473      & 90.473      \\
        \bottomrule
    \end{tabular}
  \end{threeparttable}
\end{table}

\section{Параграф "--- два}\label{sec:ch3/sect2}

Некоторый текст.

\section{Параграф с подпараграфами}\label{sec:ch3/sect3}

\subsection{Подпараграф "--- один}\label{subsec:ch3/sect3/sub1}

Некоторый текст.

\subsection{Подпараграф "--- два}\label{subsec:ch3/sect3/sub2}

Некоторый текст.

\clearpage
